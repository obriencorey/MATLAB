location_smooth15 = [
    -7
-6.9
-6.8
-6.7
-6.6
-6.5
-6.4
-6.3
-6.2
-6.1
-6
-5.9
-5.8
-5.7
-5.6
-5.5
-5.4
-5.3
-5.2
-5.1
-5
-4.9
-4.8
-4.7
-4.6
-4.5
-4.4
-4.3
-4.2
-4.1
-4
-3.9
-3.8
-3.7
-3.6
-3.5
-3.4
-3.3
-3.2
-3.1
-3
-2.9
-2.8
-2.7
-2.6
-2.5
-2.4
-2.3
-2.2
-2.1
-2
-1.9
-1.8
-1.7
-1.6
-1.5
-1.4
-1.3
-1.2
-1.1
-1
-0.9
-0.8
-0.7
-0.6
-0.5
-0.4
-0.3
-0.2
-0.1
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
1.1
1.2
1.3
1.4
1.5
1.6
1.7
1.8
1.9
2
2.1
2.2
2.3
2.4
2.5
2.6
2.7
2.8
2.9
3
3.1
3.2
3.3
3.4
3.5
3.6
3.7
3.8
3.9
4
4.1
4.2
4.3
4.4
4.5
4.6
4.7
4.8
4.9
5
5.1
5.2
5.3
5.4
5.5
5.6
5.7
5.8
5.9
6
6.1
6.2
6.3
6.4
6.5
6.6
6.7
6.8
6.9
];
velocity_rough30 = [
    19.7404984
19.80817211
19.85276097
19.7835561
19.71256712
19.7145093
19.67013724
19.6219576
19.62983925
19.61058907
19.63754474
19.67466749
19.69993391
19.6512213
19.53282956
19.7048255
19.71311364
19.67603605
19.686298
19.66286536
19.61240478
19.64581481
19.58252681
19.65545797
19.65868741
19.6622556
19.62886815
19.6592249
19.52760374
19.67254916
19.52992984
19.50291546
19.57703451
19.58179511
19.6531138
19.71093659
19.66845703
19.74276126
19.72224641
19.69121668
19.67752205
19.63475342
19.64970369
19.70152379
19.65152392
19.5562622
19.47349819
19.40591933
19.47282972
19.50087843
19.30424389
19.16206269
19.04954718
19.11089752
19.20526945
19.0789238
18.73786778
18.69171162
18.70788141
18.67509017
18.3886275
18.05019117
17.72185418
17.83032273
17.56163328
17.76101397
17.4241359
17.3399672
17.04554611
17.13073107
17.42792993
17.29682819
17.27592039
17.45269951
17.39862558
17.4987292
17.48415381
17.5871978
17.59632605
17.69630773
18.11534005
18.13683954
18.37742157
18.85397859
18.59684286
18.74863108
18.97436219
19.24828198
19.21497583
19.34651117
19.50502927
19.63008766
19.65044443
19.66105868
19.66007404
19.57021429
19.72356529
19.72006936
19.69882732
19.81294175
19.83832108
19.60818619
19.80473942
19.74375494
19.76229147
19.67897191
19.59562524
19.60584654
19.58076078
19.61114011
19.48942408
19.53512856
19.55235526
19.47078365
19.53246371
19.57358826
19.50337165
19.5827662
19.59821331
19.58642924
19.57642927
19.62618524
19.53745466
19.42840346
19.46421637
19.46320463
19.46113598
19.55563438
19.66972171
19.61727379
19.57918897
19.57099568
19.64877325
19.62511026
19.66998819
19.78477561
19.7430684
19.75297804
19.75777929
19.7480729
];
velocity_airfoil30 = [
    19.50838518
19.4899164
19.46666442
19.44175031
19.34820042
19.34919409
19.38057612
19.41167812
19.39222469
19.2786613
19.34404505
19.35159246
19.33087887
19.35247322
19.41829057
19.30286178
19.2877218
19.25549515
19.24984476
19.23378789
19.29953749
19.22351691
19.15195432
19.13099683
19.12934372
19.06064471
19.06385609
18.97478676
19.00750574
18.91234338
18.88120977
18.94193229
18.82716746
18.873834
18.92512564
18.92797117
18.97783553
18.95617344
18.8739153
18.90990437
18.85137245
18.89409592
18.86938957
18.9196243
18.83169319
18.76810709
18.81949358
18.82948001
18.81186939
18.88695953
18.92962428
18.88362621
18.84704094
18.91429008
18.83035625
18.89515734
18.8665576
18.88644463
18.91705882
18.98249225
19.00385624
19.23199024
19.23685925
19.04258694
18.57113832
18.15495151
17.95907578
18.1867807
18.53810769
18.82210875
18.87964699
18.88265963
18.94280401
18.81344572
18.77667527
18.8400536
18.89719437
18.83493618
18.86267323
18.77002668
18.81299857
18.7790917
18.72003133
18.68309828
18.7746292
18.73692379
18.76655334
18.88420434
18.89124588
18.85697316
18.89325581
18.89232537
18.96462419
19.05405936
18.98941635
19.01340455
19.06338635
18.97140827
18.91713109
18.93587991
18.93583022
18.93093864
18.97968286
18.95765943
19.01521574
19.05760949
18.99079395
18.97956543
18.98378854
19.07290755
19.02358067
19.02113714
19.14861648
19.14779444
19.16428943
19.18553598
19.27475436
19.27348065
19.35366562
19.39895457
19.37550839
19.45437448
19.4447765
19.45233294
19.46427961
19.39198079
19.43870605
19.49999315
19.42802857
19.43999783
19.49453246
19.41050378
19.35524195
19.40289314
19.52671847
19.52163266
19.51008346
19.5293788
19.61833973
19.65960882
];

velocity_smooth15 = [
    9.635109334
9.633817558
9.621396633
9.650100261
9.663167075
9.656387508
9.664269149
9.663171591
9.657281814
9.626184335
9.641459814
9.636075908
9.623822101
9.611509577
9.584305493
9.576319967
9.536997577
9.585529518
9.593248559
9.577160073
9.573492513
9.563867425
9.520457421
9.482684259
9.480714978
9.447332048
9.437336591
9.413176763
9.391749538
9.387485773
9.342232956
9.407106318
9.323064081
9.258881774
9.26367851
9.236939646
9.239234129
9.112897514
9.088069214
9.022378329
9.03433855
8.957595301
8.997839098
8.94400455
8.928706488
8.821611014
8.843083406
8.746019523
8.821823299
8.716566122
8.569863706
8.539922502
8.440464768
8.351987131
8.360252692
8.347623999
8.311427165
8.211251276
8.195474443
8.050407072
8.167782555
7.994418059
7.897345143
7.788343622
8.089923681
8.232615267
8.087538863
8.171251381
8.088320252
8.039395358
7.97373609
8.095542455
8.08896614
8.037520927
7.939571771
7.786162056
7.900664917
8.024219246
8.009128951
8.17660367
8.207014611
8.18246183
8.316300685
8.367226477
8.402393503
8.442113363
8.365356563
8.328157022
8.524583788
8.550279295
8.608309856
8.722324914
8.91316904
8.91318259
8.816032889
8.841055407
8.909551163
8.904984779
8.954731713
9.067003325
9.056958184
9.179460121
9.124785468
9.143755608
9.217391368
9.255860102
9.259879965
9.27453214
9.297002722
9.3075176
9.283014502
9.35999262
9.388506548
9.400209317
9.413822651
9.395543566
9.406519147
9.393818187
9.364951957
9.43450462
9.447241714
9.434337502
9.468018534
9.499766419
9.50580073
9.439748509
9.464093522
9.46291918
9.482521658
9.467318446
9.462670762
9.482634576
9.509165671
9.533235166
9.520574856
9.54421978
9.574517804
9.599463538
9.60253941
9.609504162
];

velocity_smooth20 = [
    12.98482052
12.9642605
12.92223713
12.92300045
12.88462657
12.93033105
12.95566522
12.93136086
12.87005117
12.86081452
12.85912528
12.8394144
12.87898521
12.85952275
12.86899427
12.86995632
12.88050734
12.83887691
12.85960405
12.86543511
12.84411177
12.79025464
12.73219246
12.77483462
12.75427912
12.76193493
12.77829893
12.74584644
12.78366929
12.73733698
12.62378714
12.62584224
12.59321812
12.58831298
12.58532744
12.54535916
12.55936545
12.58254064
12.5595145
12.50394102
12.40701264
12.3702467
12.38297476
12.28663807
12.22145305
12.20805201
12.19858049
12.11480022
11.99172918
12.05877507
11.94894248
11.82320207
11.76784087
11.6519017
11.66316183
11.64017183
11.64873098
11.54159937
11.45068723
11.49438631
11.54488753
11.43567372
11.2119977
11.2073726
11.11549389
11.14464919
10.98891338
10.99718797
11.03413458
10.81240526
11.03130712
11.18378188
11.00078326
10.8009509
10.94107249
10.90783409
10.97062526
11.15408458
11.12915691
11.0735473
11.21300493
11.17081895
11.04052571
11.16092738
11.20706547
11.13483892
11.34529004
11.35712831
11.37921497
11.41373159
11.52617032
11.67943099
11.65253404
11.75831515
11.82683349
11.8995885
12.03562247
11.97114206
12.17141254
12.19386053
12.17451099
12.29758655
12.35075263
12.33177345
12.39695395
12.56592821
12.58521452
12.59660564
12.59680889
12.67220616
12.72689888
12.64794697
12.74642458
12.75706141
12.67308692
12.71539485
12.7611174
12.78276595
12.77259434
12.81841626
12.85625717
12.80535396
12.7860541
12.83955442
12.78703875
12.7220344
12.66499751
12.77329894
12.83151921
12.77486624
12.75917071
12.78814082
12.78768012
12.75179945
12.7534616
12.80244973
12.80420672
12.84280644
12.87525893
12.90018208
];

velocity_smooth25 = [
    16.41199763
16.38903021
16.32788313
16.31730502
16.27135663
16.28120303
16.29649658
16.29151918
16.31358777
16.22740462
16.30126621
16.29982087
16.25412542
16.21918874
16.24087793
16.18512379
16.25141991
16.33660939
16.26916603
16.33707913
16.3010449
16.34236818
16.32234114
16.31670429
16.24817241
16.31724178
16.21991141
16.15955023
16.21973978
16.18968566
16.14553943
16.1031231
16.18209308
16.19640199
16.17618976
16.16312746
16.02571138
15.88325918
15.92969085
16.01536362
15.93105942
15.89192221
15.66894628
15.65956961
15.78045005
15.48270016
15.47324219
15.35709976
15.38864891
15.31511252
15.20663945
15.34060477
15.03612048
14.80846073
14.70191629
14.91524455
14.87343798
14.74292341
14.75229557
14.48026376
14.36946007
14.48901712
14.43097753
14.4116867
14.37345735
14.29659667
13.98035089
14.09088357
14.28931123
14.47649231
14.22055802
14.2081371
14.26153353
14.06053586
14.26104572
14.47753567
14.19630786
14.21870166
14.34881424
14.27945128
14.27849825
14.47242277
14.61332122
14.7207961
14.73463979
14.81585005
14.85027634
14.94251639
14.66995161
14.77005975
15.00429581
15.14910573
15.27972417
15.05729025
15.28205028
15.47294408
15.61042792
15.70997147
15.55724829
15.76476355
15.74231556
16.01603661
16.10135256
16.17776157
16.09455944
16.14783391
16.38086402
16.3631721
16.30065194
16.23284273
16.36983424
16.37968516
16.43214211
16.45944105
16.49062434
16.46647807
16.42434629
16.37086856
16.30155528
16.46715105
16.42641042
16.33457688
16.36021367
16.35735008
16.38333465
16.33962203
16.38402119
16.32224629
16.29912078
16.35922902
16.32400328
16.2765418
16.2953674
16.23923386
16.28589137
16.33481174
16.39084592
16.38865081
16.35778368
16.43589549
];

velocity_smooth30 = [
    19.92023144
19.94094051
20.01713272
20.00633781
19.96126566
19.96039393
19.9466451
19.90837962
19.88188917
19.85623432
19.88307255
19.91195233
19.86973022
19.93155029
19.88842484
19.90771115
19.87543481
19.90334801
19.95718256
20.08029425
19.95908409
19.98829811
20.0163694
19.95164057
19.92730459
20.05938193
20.02025828
20.10271515
20.20691994
20.12642783
20.12970243
20.08494194
19.94837048
19.9889169
20.07029428
19.97867302
20.00772895
19.99130171
19.97305425
19.85857397
19.83579625
19.85134725
19.84182153
19.6593875
19.38329969
19.44636637
19.44134832
19.4412625
19.28740112
19.21210321
18.90834159
18.76604747
18.74528872
18.81499495
18.647728
18.61568653
18.69037468
18.62484188
18.46491005
18.35368631
18.09626603
17.96434225
17.91433787
17.94927906
18.07963102
17.63516967
17.36518393
17.53487635
17.40302936
17.4167782
17.6723376
17.55387359
17.24066755
17.65423015
17.55820962
17.30130876
17.46675548
17.61391408
17.78548997
17.69383257
17.59911738
17.96063404
17.93981206
18.00973057
17.86571108
18.01315875
18.22004619
18.63554646
18.5899323
18.46012235
18.72471515
18.7495299
18.85207706
18.8652613
19.05078024
19.29067573
19.44073857
19.41760855
19.58432898
19.78578735
19.62601812
19.84594979
19.97288713
19.9460489
19.96629275
20.12771057
20.3622628
20.20499131
20.30990521
20.28968847
20.19193804
20.18934094
20.25805802
20.20846013
20.19960288
20.12635556
20.30786818
20.24265607
20.22019
20.22638691
20.25374908
20.2675205
20.22859106
20.19956223
20.17114316
20.21833364
20.2217844
20.0420649
20.02893486
20.11873589
20.06977034
20.08407925
20.02000986
20.0576701
20.16236269
20.12661301
20.14837899
20.2447202
20.17497784
20.17447196
];


deficit_smooth15 = 9.035079029 -1.*velocity_smooth15;
deficit_smooth20 = 12.188988-1.*velocity_smooth20;
deficit_smooth25 = 15.49193338-1.*velocity_smooth25;
deficit_smooth30 = 18.-1.*velocity_smooth30;
deficit_rough30 = 18.-1.*velocity_rough30;
deficit_airfoil30 = 18.-1.*velocity_airfoil30;

location_metric = 0.0254.*location_smooth15;

h = .3048;
rho = 1.225;
U_inf_15 = 9.035079029;
U_inf_20 = 12.188988;
U_inf_25 = 15.49193338;
U_inf_30 = 18.77905911;
drag15 = 0;
drag20 = 0;
drag25 = 0;
drag30 = 0;

for x = 1:(length(location_metric)-1);
    deltax = location_metric(x + 1) - location_metric(x);
    
    if(velocity_smooth15(x) > U_inf_15)
        velocity_smooth15(x) = U_inf_15;
    end
    
    drag15 = drag15 + deltax * (velocity_smooth15(x) * (U_inf_15 - velocity_smooth15(x)));
end

drag15 = drag15 * h * rho;
for x = 1:(length(location_metric)-1);
    deltax = location_metric(x + 1) - location_metric(x);
    
    if(velocity_smooth20(x) > U_inf_20)
        velocity_smooth20(x) = U_inf_20;
    end
    
    drag20 = drag20 + deltax * (velocity_smooth20(x) * (U_inf_20 - velocity_smooth20(x)));
end

drag20 = drag20 * h * rho;

for x = 1:(length(location_metric)-1);
    deltax = location_metric(x + 1) - location_metric(x);
    
    if(velocity_smooth25(x) > U_inf_25)
        velocity_smooth25(x) = U_inf_25;
    end
    
    drag25 = drag25 + deltax * (velocity_smooth25(x) * (U_inf_25 - velocity_smooth25(x)));
end

drag25 = drag25 * h * rho;


for x = 1:(length(location_metric)-1);
    deltax = location_metric(x + 1) - location_metric(x);
    
    if(velocity_smooth30(x) > U_inf_30)
        velocity_smooth30(x) = U_inf_30;
    end
    
    drag30 = drag30 + deltax * (velocity_smooth30(x) * (U_inf_30 - velocity_smooth30(x)));
end

drag30 = drag30 * h * rho;

plot(location_smooth15,deficit_airfoil30);
title("Velocity Deficit for Airfoil at 30Hz")
xlabel("location (in)");
ylabel("velocity deficit (m/s");